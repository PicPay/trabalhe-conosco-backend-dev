/*! date-extended - v0.0.6 - 2014-04-01
* Copyright (c) 2014 Doug Martin; Licensed MIT */
(function(){"use strict";function e(e,t,r){function n(e,t,r,n){e=""+e,r=r||" ";for(var a=e.length;t>a;)n?e+=r:e=r+e,a++;return e}function a(e,r,n){var i=e;if(t.isString(i)){if(e.length>r)if(n){var u=e.length;i=e.substring(u-r,u)}else i=e.substring(0,r)}else i=a(""+i,r);return i}function i(e,r,n){if(!t.isArray(e)||"function"!=typeof r)throw new TypeError;for(var a=Object(e),i=a.length>>>0,u=0;i>u;u++)if(u in a&&!r.call(n,a[u],u,a))return!1;return!0}function u(e,t){return U.difference(new Date(e.getFullYear(),0,1,e.getHours()),e,null,t)+1}function o(e,t,r){t=t||0;var n=e[r?"getUTCFullYear":"getFullYear"](),a=new Date(n,0,1).getDay(),i=(a-t+7)%7,o=h((u(e)+i-1)/7);return a===t&&o++,o}function s(e){var t=""+e,r="",n=t.indexOf("(");return n>-1&&(r=t.substring(++n,t.indexOf(")"))),r}function f(e,t){return e.replace(/([a-z])\1*/gi,function(e){var r,n=e.charAt(0),a=e.length,i="0?",u="0{0,2}";if("y"===n)r="\\d{2,4}";else if("M"===n)r=a>2?"\\S+?":"1[0-2]|"+i+"[1-9]";else if("D"===n)r="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+u+"[1-9][0-9]|"+i+"[1-9]";else if("d"===n)r="3[01]|[12]\\d|"+i+"[1-9]";else if("w"===n)r="[1-4][0-9]|5[0-3]|"+i+"[1-9]";else if("E"===n)r="\\S+";else if("h"===n)r="1[0-2]|"+i+"[1-9]";else if("K"===n)r="1[01]|"+i+"\\d";else if("H"===n)r="1\\d|2[0-3]|"+i+"\\d";else if("k"===n)r="1\\d|2[0-4]|"+i+"[1-9]";else if("m"===n||"s"===n)r="[0-5]\\d";else if("S"===n)r="\\d{"+a+"}";else if("a"===n){var o="AM",s="PM";r=o+"|"+s,o!==o.toLowerCase()&&(r+="|"+o.toLowerCase()),s!==s.toLowerCase()&&(r+="|"+s.toLowerCase()),r=r.replace(/\./g,"\\.")}else r="v"===n||"z"===n||"Z"===n||"G"===n||"q"===n||"Q"===n?".*":" "===n?"\\s*":n+"*";return t&&t.push(e),"("+r+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}function l(e){Y[e+"sFromNow"]=function(t){return U.add(new Date,e,t)},Y[e+"sAgo"]=function(t){return U.add(new Date,e,-t)}}for(var d=function(){function e(e,t,r){return e=e.replace(/s$/,""),a.hasOwnProperty(e)?a[e](t,r):[r,"UTC"+e.charAt(0).toUpperCase()+e.substring(1)+"s",!1]}function t(e,t,r,a){return e=e.replace(/s$/,""),n(i[e](t,r,a))}var r=Math.floor,n=Math.round,a={day:function(e,t){return[t,"Date",!1]},weekday:function(e,t){var r,n,a=t%5,i=e.getDay(),u=0;a?(r=a,n=parseInt(t/5,10)):(r=t>0?5:-5,n=t>0?(t-5)/5:(t+5)/5),6===i&&t>0?u=1:0===i&&0>t&&(u=-1);var o=i+r;return(0===o||6===o)&&(u=t>0?2:-2),[7*n+r+u,"Date",!1]},year:function(e,t){return[t,"FullYear",!0]},week:function(e,t){return[7*t,"Date",!1]},quarter:function(e,t){return[3*t,"Month",!0]},month:function(e,t){return[t,"Month",!0]}},i={quarter:function(e,t,n){var a=t.getFullYear()-e.getFullYear(),i=e[n?"getUTCMonth":"getMonth"](),u=t[n?"getUTCMonth":"getMonth"](),o=r(i/3)+1,s=r(u/3)+1;return s+=4*a,s-o},weekday:function(e,r,n){var a,i=t("day",e,r,n),u=i%7;if(0===u)i=5*t("week",e,r,n);else{var o=0,s=e[n?"getUTCDay":"getDay"](),f=r[n?"getUTCDay":"getDay"]();a=parseInt(i/7,10);var l=new Date(+e);l.setDate(l[n?"getUTCDate":"getDate"]()+7*a);var d=l[n?"getUTCDay":"getDay"]();i>0?6===s||6===f?o=-1:0===s?o=0:(0===f||d+u>5)&&(o=-2):0>i&&(6===s?o=0:0===s||0===f?o=1:(6===f||0>d+u)&&(o=2)),i+=o,i-=2*a}return i},year:function(e,t){return t.getFullYear()-e.getFullYear()},month:function(e,t,r){var n=e[r?"getUTCMonth":"getMonth"](),a=t[r?"getUTCMonth":"getMonth"]();return a-n+12*(t.getFullYear()-e.getFullYear())},week:function(e,r,a){return n(t("day",e,r,a)/7)},day:function(e,t){return 1.1574074074074074e-8*(t.getTime()-e.getTime())},hour:function(e,t){return 2.7777777777777776e-7*(t.getTime()-e.getTime())},minute:function(e,t){return 16666666666666667e-21*(t.getTime()-e.getTime())},second:function(e,t){return.001*(t.getTime()-e.getTime())},millisecond:function(e,t){return t.getTime()-e.getTime()}};return{addTransform:e,differenceTransform:t}}(),g=d.addTransform,c=d.differenceTransform,h=Math.floor,y=Math.round,D=Math.min,p=Math.pow,m=Math.ceil,v=Math.abs,M=["January","February","March","April","May","June","July","August","September","October","November","December"],T=["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."],w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],C=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],x=["Before Christ","Anno Domini"],F=["BC","AD"],U={getDaysInMonth:function(e){var t=e.getMonth(),r=[31,28,31,30,31,30,31,31,30,31,30,31];return 1===t&&U.isLeapYear(e)?29:r[t]},isLeapYear:function(e,t){var r=e[t?"getUTCFullYear":"getFullYear"]();return 0===r%400||0===r%4&&0!==r%100},isWeekend:function(e,t){var r=(e||new Date)[t?"getUTCDay":"getDay"]();return 0===r||6===r},getTimezoneName:s,compare:function(e,t,r){return e=new Date(+e),t=new Date(+(t||new Date)),"date"===r?(e.setHours(0,0,0,0),t.setHours(0,0,0,0)):"time"===r&&(e.setFullYear(0,0,0),t.setFullYear(0,0,0)),e>t?1:t>e?-1:0},add:function(e,t,r){var n=g(t,e,r||0);r=n[0];var a=n[1],i=new Date(+e),u=n[2];return a&&i["set"+a](i["get"+a]()+r),u&&i.getDate()<e.getDate()&&i.setDate(0),i},difference:function(e,t,r,n){return t=t||new Date,r=r||"day",c(r,e,t,n)},format:function(e,t,r){r=r||!1;var i,f,l,d,g,c,D,U;return r?(i=e.getUTCFullYear(),f=e.getUTCMonth(),l=e.getUTCDay(),d=e.getUTCDate(),g=e.getUTCHours(),c=e.getUTCMinutes(),D=e.getUTCSeconds(),U=e.getUTCMilliseconds()):(i=e.getFullYear(),f=e.getMonth(),d=e.getDate(),l=e.getDay(),g=e.getHours(),c=e.getMinutes(),D=e.getSeconds(),U=e.getMilliseconds()),t.replace(/([A-Za-z])\1*/g,function(t){var Y,b,A=t.charAt(0),S=t.length;if("d"===A)Y=""+d,b=!0;else if("H"!==A||Y)if("m"!==A||Y)if("s"===A)Y||(Y=""+D),b=!0;else if("G"===A)Y=(4>S?F:x)[0>i?0:1];else if("y"===A)Y=i,S>1&&(2===S?Y=a(""+Y,2,!0):b=!0);else if("Q"===A.toUpperCase())Y=m((f+1)/3),b=!0;else if("M"===A)3>S?(Y=f+1,b=!0):Y=(3===S?T:M)[f];else if("w"===A)Y=o(e,0,r),b=!0;else if("D"===A)Y=u(e,r),b=!0;else if("E"===A)3>S?(Y=l+1,b=!0):Y=(-3===S?C:w)[l];else if("a"===A)Y=12>g?"AM":"PM";else if("h"===A)Y=g%12||12,b=!0;else if("K"===A)Y=g%12,b=!0;else if("k"===A)Y=g||24,b=!0;else if("S"===A)Y=y(U*p(10,S-3)),b=!0;else if("z"===A||"v"===A||"Z"===A){if(Y=s(e),"z"!==A&&"v"!==A||Y||(S=4),!Y||"Z"===A){var O=e.getTimezoneOffset(),L=[O>=0?"-":"+",n(h(v(O)/60),2,"0"),n(v(O)%60,2,"0")];4===S&&(L.splice(0,0,"GMT"),L.splice(3,0,":")),Y=L.join("")}}else Y=t;else Y=""+c,b=!0;else Y=""+g,b=!0;return b&&(Y=n(Y,S,"0")),Y})}},Y={},b=["year","month","day","hour","minute","second"],A=0,S=b.length;S>A;A++)l(b[A]);var O={parseDate:function(e,t){if(!t)throw Error("format required when calling dateExtender.parse");var n=[],a=f(t,n),u=RegExp("^"+a+"$","i"),o=u.exec(e);if(!o)return null;var s=[1970,0,1,0,0,0,0],l="",d=i(o,function(e,t){if(t){var a=n[t-1],i=a.length,u=a.charAt(0);if("y"===u)if(100>e){e=parseInt(e,10);var o=""+(new Date).getFullYear(),f=100*o.substring(0,2),d=D(o.substring(2,4)+20,99);s[0]=d>e?f+e:f-100+e}else s[0]=e;else if("M"===u){if(i>2){var g,c,h=M;3===i&&(h=T),e=e.replace(".","").toLowerCase();var y=!1;for(g=0,c=h.length;c>g&&!y;g++){var p=h[g].replace(".","").toLocaleLowerCase();p===e&&(e=g,y=!0)}if(!y)return!1}else e--;s[1]=e}else if("E"===u||"e"===u){var m=w;3===i&&(m=C),e=e.toLowerCase(),m=r.map(m,function(e){return e.toLowerCase()});var v=r.indexOf(m,e);if(-1===v){if(e=parseInt(e,10),isNaN(e)||e>m.length)return!1}else e=v}else if("D"===u||"d"===u)"D"===u&&(s[1]=0),s[2]=e;else if("a"===u){var x="am",F="pm",U=/\./g;e=e.replace(U,"").toLowerCase(),l=e===F?"p":e===x?"a":""}else"k"===u||"h"===u||"H"===u||"K"===u?("k"===u&&24===+e&&(e=0),s[3]=e):"m"===u?s[4]=e:"s"===u?s[5]=e:"S"===u&&(s[6]=e)}return!0});if(d){var g=+s[3];"p"===l&&12>g?s[3]=g+12:"a"===l&&12===g&&(s[3]=0);var c=new Date(s[0],s[1],s[2],s[3],s[4],s[5],s[6]),h=-1!==r.indexOf(n,"d"),y=-1!==r.indexOf(n,"M"),p=s[1],m=s[2],v=c.getMonth(),x=c.getDate();return y&&v>p||h&&x>m?null:c}return null}},L=e.define(t.isDate,U).define(t.isString,O).define(t.isNumber,Y);for(A in U)U.hasOwnProperty(A)&&(L[A]=U[A]);for(A in O)O.hasOwnProperty(A)&&(L[A]=O[A]);for(A in Y)Y.hasOwnProperty(A)&&(L[A]=Y[A]);return L}"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(module.exports=e(require("extended"),require("is-extended"),require("array-extended"))):"function"==typeof define&&define.amd?define(["extended","is-extended","array-extended"],function(t,r,n){return e(t,r,n)}):this.dateExtended=e(this.extended,this.isExtended,this.arrayExtended)}).call(this);